<link rel="import" href="../polymer/polymer.html"> <link rel="import" href="../simpla-styles/simpla-styles.html"> <link rel="import" href="../iron-iconset-svg/iron-iconset-svg.html"> <link rel="import" href="../iron-icon/iron-icon.html" async> <iron-iconset-svg name="simpla-article-toolbar"> <svg> <defs> <g id="format-bold"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"/></g> <g id="format-italic"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"/></g> <g id="format-quote"><path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"/></g> <g id="format-size"><path d="M9 4v3h5v12h3V7h5V4H9zm-6 8h3v7h3v-7h3V9H3v3z"/></g> <g id="insert-link"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></g> <g id="add-a-photo"><path d="M3 4V1h2v3h3v2H5v3H3V6H0V4h3zm3 6V7h3V4h7l1.83 2H21c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V10h3zm7 9c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-3.2-5c0 1.77 1.43 3.2 3.2 3.2s3.2-1.43 3.2-3.2-1.43-3.2-3.2-3.2-3.2 1.43-3.2 3.2z"/></g> <g id="vertical-align-bottom"><path d="M16 13h-3V3h-2v10H8l4 4 4-4zM4 19v2h16v-2H4z"/></g> <g id="vertical-align-center"><path d="M8 19h3v4h2v-4h3l-4-4-4 4zm8-14h-3V1h-2v4H8l4 4 4-4zM4 11v2h16v-2H4z"/></g> <g id="vertical-align-top"><path d="M8 11h3v10h2V11h3l-4-4-4 4zM4 3v2h16V3H4z"/></g> </defs> </svg> </iron-iconset-svg> <dom-module id="simpla-article-toolbar"> <template> <style>*,::after,::before,:host{box-sizing:border-box}:host{--iron-icon-width:var(--simpla-scale-0);--iron-icon-height:var(--simpla-scale-0);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.toolbar{display:none;font-size:var(--simpla-scale-0);z-index:var(--simpla-on-top)}.toolbar[visible]{display:flex}.bar{background:var(--simpla-grey-700);color:#fff;border-radius:var(--simpla-border-radius)}.bar__tool{padding:.4em .5em;border-bottom:2px solid transparent}.bar__tool[active]{border-color:var(--simpla-primary-color);color:var(--simpla-primary-color)}.bar--range{overflow:hidden}.bar__tool--range{transition:margin-left 150ms var(--simpla-easing-standard)}.range__link{font-family:var(--simpla-font-family);font-size:var(--simpla-scale-000);color:#fff;outline:0;border:0;width:0;background:0 0;transition:width 150ms var(--simpla-easing-standard),padding 150ms var(--simpla-easing-standard)}.range__link::-webkit-input-placeholder{color:var(--simpla-med-white)}.range__link:-ms-input-placeholder{color:var(--simpla-med-white)}.range__link::placeholder{color:var(--simpla-med-white)}.bar--range[data-link-active] .range__link{width:12em;padding:0 .5em}.bar--range[data-link-active] .bar__tool{margin-left:-1.5em}.bar--range[data-link-active] .bar__tool:not(.bar__tool--range-link){visibility:hidden}.newline{color:var(--simpla-grey-700);transition:color .1s ease;margin-right:.5em;padding-bottom:.3em}.newline:hover{color:var(--simpla-text-color)}.bar__tool--image iron-icon{transform:rotate(-90deg)}button{font:inherit;color:inherit;line-height:normal;background:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;border:0;padding:0;outline:0;cursor:pointer}iron-icon{pointer-events:none}[hidden]{display:none!important}</style> <div class="toolbar bar bar--range" data-context="range" visible$="[[_isContext(&apos;range&apos;, context)]]" data-link-active$="[[_rangeLinkActive]]"> <button class="bar__tool bar__tool--range" data-format="bold" on-tap="_format" active$="[[state.bold.applied]]"> <iron-icon icon="simpla-article-toolbar:format-bold"> </iron-icon> </button> <button class="bar__tool bar__tool--range" data-format="italic" on-tap="_format" active$="[[state.italic.applied]]"> <iron-icon icon="simpla-article-toolbar:format-italic"> </iron-icon> </button> <button class="bar__tool bar__tool--range" data-format="heading" on-tap="_formatHeading" active$="[[state.heading.applied]]"> <iron-icon icon="simpla-article-toolbar:format-size"> </iron-icon> </button> <button class="bar__tool bar__tool--range" data-format="blockquote" on-tap="_format" active$="[[state.blockquote.applied]]"> <iron-icon icon="simpla-article-toolbar:format-quote"> </iron-icon> </button> <button class="bar__tool bar__tool--range bar__tool--range-link" data-format="link" active$="[[state.link.applied]]" on-tap="_toggleLink"> <iron-icon icon="simpla-article-toolbar:insert-link"> </iron-icon> </button> <input id="range-link-input" class="range__link" type="text" value="{{_linkHref::input}}" on-keyup="_exitLinkOnExitKeys" placeholder="Enter a URL..."> </div> <button class="toolbar newline" data-context="newLine" on-tap="_embed" data-embed="image" visible$="[[_isContext(&apos;newLine&apos;, context)]]"> <iron-icon icon="simpla-article-toolbar:add-a-photo"> </iron-icon> </button> <div class="toolbar bar" data-context="image" visible$="[[_isContext(&apos;image&apos;, context)]]"> <button class="bar__tool bar__tool--image" data-align="left" on-tap="_alignImage" active$="[[_equals(state.image.meta.alignment, &apos;left&apos;)]]"> <iron-icon icon="simpla-article-toolbar:vertical-align-top"> </iron-icon> </button> <button class="bar__tool bar__tool--image" data-align="center" on-tap="_alignImage" active$="[[_equals(state.image.meta.alignment, &apos;center&apos;)]]"> <iron-icon icon="simpla-article-toolbar:vertical-align-center"> </iron-icon> </button> <button class="bar__tool bar__tool--image" data-align="right" on-tap="_alignImage" active$="[[_equals(state.image.meta.alignment, &apos;right&apos;)]]"> <iron-icon icon="simpla-article-toolbar:vertical-align-bottom"> </iron-icon> </button> </div> </template> <script>!function(){"use strict";function t(t){var e=!1,n=0,o=document.createElement("span"),i=new MutationObserver(function(){t(),e=!1});return i.observe(o,{attributes:!0}),function(){e||(e=!0,o.setAttribute("x-index",n),n+=1)}}function e(t){var e=!1;return function(){e||(e=!0,setTimeout(function(){e=!1,t()},ft))}}function n(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function o(t,e){Object.keys(e).forEach(function(o){var i="";["width","height","top","right","bottom","left"].indexOf(o)!==-1&&n(e[o])&&(i="px"),t.style[o]=e[o]+i})}function i(t){var e={};return t&&"[object Function]"===e.toString.call(t)}function r(t,e){if(1!==t.nodeType)return[];var n=window.getComputedStyle(t,null);return e?n[e]:n}function a(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function s(t){if(!t||["HTML","BODY","#document"].indexOf(t.nodeName)!==-1)return window.document.body;var e=r(t),n=e.overflow,o=e.overflowX,i=e.overflowY;return/(auto|scroll)/.test(n+i+o)?t:s(a(t))}function f(t){var e=t.nodeName;return"BODY"!==e&&("HTML"===e||t.firstElementChild.offsetParent===t)}function p(t){return null!==t.parentNode?p(t.parentNode):t}function u(t){var e=t&&t.offsetParent,n=e&&e.nodeName;return n&&"BODY"!==n&&"HTML"!==n?e:window.document.documentElement}function d(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return window.document.documentElement;var n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,o=n?t:e,i=n?e:t,r=document.createRange();r.setStart(o,0),r.setEnd(i,0);var a=r.commonAncestorContainer;if(t!==a&&e!==a||o.contains(i))return f(a)?a:u(a);var s=p(t);return s.host?d(s.host,e):d(t,p(e).host)}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n="top"===e?"scrollTop":"scrollLeft",o=t.nodeName;if("BODY"===o||"HTML"===o){var i=window.document.documentElement,r=window.document.scrollingElement||i;return r[n]}return t[n]}function c(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=l(e,"top"),i=l(e,"left"),r=n?-1:1;return t.top+=o*r,t.bottom+=o*r,t.left+=i*r,t.right+=i*r,t}function h(t,e){var n="x"===e?"Left":"Top",o="Left"===n?"Right":"Bottom";return+t["border"+n+"Width"].split("px")[0]+ +t["border"+o+"Width"].split("px")[0]}function m(t,e,n,o){return Math.max(e["offset"+t],n["client"+t],n["offset"+t],ct()?n["offset"+t]+o["margin"+("Height"===t?"Top":"Left")]+o["margin"+("Height"===t?"Bottom":"Right")]:0)}function g(){var t=window.document.body,e=window.document.documentElement,n=ct()&&window.getComputedStyle(e);return{height:m("Height",t,e,n),width:m("Width",t,e,n)}}function v(t){return vt({},t,{right:t.left+t.width,bottom:t.top+t.height})}function b(t){var e={};if(ct())try{e=t.getBoundingClientRect();var n=l(t,"top"),o=l(t,"left");e.top+=n,e.left+=o,e.bottom+=n,e.right+=o}catch(t){}else e=t.getBoundingClientRect();var i={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},a="HTML"===t.nodeName?g():{},s=a.width||t.clientWidth||i.right-i.left,f=a.height||t.clientHeight||i.bottom-i.top,p=t.offsetWidth-s,u=t.offsetHeight-f;if(p||u){var d=r(t);p-=h(d,"x"),u-=h(d,"y"),i.width-=p,i.height-=u}return v(i)}function w(t,e){var n=ct(),o="HTML"===e.nodeName,i=b(t),a=b(e),f=s(t),p=v({top:i.top-a.top,left:i.left-a.left,width:i.width,height:i.height});if(o||"BODY"===e.nodeName){var u=r(e),d=n&&o?0:+u.borderTopWidth.split("px")[0],l=n&&o?0:+u.borderLeftWidth.split("px")[0],h=n&&o?0:+u.marginTop.split("px")[0],m=n&&o?0:+u.marginLeft.split("px")[0];p.top-=d-h,p.bottom-=d-h,p.left-=l-m,p.right-=l-m,p.marginTop=h,p.marginLeft=m}return(n?e.contains(f):e===f&&"BODY"!==f.nodeName)&&(p=c(p,e)),p}function y(t){var e=window.document.documentElement,n=w(t,e),o=Math.max(e.clientWidth,window.innerWidth||0),i=Math.max(e.clientHeight,window.innerHeight||0),r=l(e),a=l(e,"left"),s={top:r-n.top+n.marginTop,left:a-n.left+n.marginLeft,width:o,height:i};return v(s)}function x(t){var e=t.nodeName;return"BODY"!==e&&"HTML"!==e&&("fixed"===r(t,"position")||x(a(t)))}function _(t,e,n,o){var i={top:0,left:0},r=d(t,e);if("viewport"===o)i=y(r);else{var f=void 0;"scrollParent"===o?(f=s(a(t)),"BODY"===f.nodeName&&(f=window.document.documentElement)):f="window"===o?window.document.documentElement:o;var p=w(f,r);if("HTML"!==f.nodeName||x(r))i=p;else{var u=g(),l=u.height,c=u.width;i.top+=p.top-p.marginTop,i.bottom=l+p.top,i.left+=p.left-p.marginLeft,i.right=c+p.left}}return i.left+=n,i.top+=n,i.right-=n,i.bottom-=n,i}function E(t){var e=t.width,n=t.height;return e*n}function O(t,e,n,o,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(t.indexOf("auto")===-1)return t;var a=_(n,o,r,i),s={top:{width:a.width,height:e.top-a.top},right:{width:a.right-e.right,height:a.height},bottom:{width:a.width,height:a.bottom-e.bottom},left:{width:e.left-a.left,height:a.height}},f=Object.keys(s).map(function(t){return vt({key:t},s[t],{area:E(s[t])})}).sort(function(t,e){return e.area-t.area}),p=f.filter(function(t){var e=t.width,o=t.height;return e>=n.clientWidth&&o>=n.clientHeight}),u=p.length>0?p[0].key:f[0].key,d=t.split("-")[1];return u+(d?"-"+d:"")}function L(t,e,n){var o=d(e,n);return w(n,o)}function k(t){var e=window.getComputedStyle(t),n=parseFloat(e.marginTop)+parseFloat(e.marginBottom),o=parseFloat(e.marginLeft)+parseFloat(e.marginRight),i={width:t.offsetWidth+o,height:t.offsetHeight+n};return i}function C(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function T(t,e,n){n=n.split("-")[0];var o=k(t),i={width:o.width,height:o.height},r=["right","left"].indexOf(n)!==-1,a=r?"top":"left",s=r?"left":"top",f=r?"height":"width",p=r?"width":"height";return i[a]=e[a]+e[f]/2-o[f]/2,n===s?i[s]=e[s]-o[p]:i[s]=e[C(s)],i}function B(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function P(t,e,n){if(Array.prototype.findIndex)return t.findIndex(function(t){return t[e]===n});var o=B(t,function(t){return t[e]===n});return t.indexOf(o)}function M(t,e,n){var o=void 0===n?t:t.slice(0,P(t,"name",n));return o.forEach(function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=t.function||t.fn;t.enabled&&i(n)&&(e=n(e,t))}),e}function N(){if(!this.state.isDestroyed){var t={instance:this,styles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=L(this.state,this.popper,this.reference),t.placement=O(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.offsets.popper=T(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position="absolute",t=M(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function H(t,e){return t.some(function(t){var n=t.name,o=t.enabled;return o&&n===e})}function S(t){for(var e=[!1,"ms","webkit","moz","o"],n=t.charAt(0).toUpperCase()+t.slice(1),o=0;o<e.length-1;o++){var i=e[o],r=i?""+i+n:t;if("undefined"!=typeof window.document.body.style[r])return r}return null}function A(){return this.state.isDestroyed=!0,H(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[S("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function D(t,e,n,o){var i="BODY"===t.nodeName,r=i?window:t;r.addEventListener(e,n,{passive:!0}),i||D(s(r.parentNode),e,n,o),o.push(r)}function W(t,e,n,o){n.updateBound=o,window.addEventListener("resize",n.updateBound,{passive:!0});var i=s(t);return D(i,"scroll",n.updateBound,n.scrollParents),n.scrollElement=i,n.eventsEnabled=!0,n}function j(){this.state.eventsEnabled||(this.state=W(this.reference,this.options,this.state,this.scheduleUpdate))}function F(t,e){return window.removeEventListener("resize",e.updateBound),e.scrollParents.forEach(function(t){t.removeEventListener("scroll",e.updateBound)}),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}function I(){this.state.eventsEnabled&&(window.cancelAnimationFrame(this.scheduleUpdate),this.state=F(this.reference,this.state))}function R(t,e){Object.keys(e).forEach(function(n){var o=e[n];o!==!1?t.setAttribute(n,e[n]):t.removeAttribute(n)})}function U(t,e){var n={position:t.offsets.popper.position},i={"x-placement":t.placement},r=Math.round(t.offsets.popper.left),a=Math.round(t.offsets.popper.top),s=S("transform");return e.gpuAcceleration&&s?(n[s]="translate3d("+r+"px, "+a+"px, 0)",n.top=0,n.left=0,n.willChange="transform"):(n.left=r,n.top=a,n.willChange="top, left"),o(t.instance.popper,vt({},n,t.styles)),R(t.instance.popper,vt({},i,t.attributes)),t.offsets.arrow&&o(t.arrowElement,t.offsets.arrow),t}function Y(t,e,n,o,i){var r=L(i,e,t),a=O(n.placement,r,e,t,n.modifiers.flip.boundariesElement);return e.setAttribute("x-placement",a),n}function q(t,e,n){var o=B(t,function(t){var n=t.name;return n===e}),i=!!o&&t.some(function(t){return t.name===n&&t.enabled&&t.order<o.order});if(!i){var r="`"+e+"`",a="`"+n+"`";console.warn(a+" modifier is required by "+r+" modifier in order to work, be sure to include it before "+r+"!")}return i}function K(t,e){if(!q(t.instance.modifiers,"arrow","keepTogether"))return t;var n=e.element;if("string"==typeof n){if(n=t.instance.popper.querySelector(n),!n)return t}else if(!t.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var o=t.placement.split("-")[0],i=v(t.offsets.popper),r=t.offsets.reference,a=["left","right"].indexOf(o)!==-1,s=a?"height":"width",f=a?"top":"left",p=a?"left":"top",u=a?"bottom":"right",d=k(n)[s];r[u]-d<i[f]&&(t.offsets.popper[f]-=i[f]-(r[u]-d)),r[f]+d>i[u]&&(t.offsets.popper[f]+=r[f]+d-i[u]);var l=r[f]+r[s]/2-d/2,c=l-v(t.offsets.popper)[f];return c=Math.max(Math.min(i[s]-d,c),0),t.arrowElement=n,t.offsets.arrow={},t.offsets.arrow[f]=Math.floor(c),t.offsets.arrow[p]="",t}function z(t){return"end"===t?"start":"start"===t?"end":t}function G(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=wt.indexOf(t),o=wt.slice(n+1).concat(wt.slice(0,n));return e?o.reverse():o}function V(t,e){if(H(t.instance.modifiers,"inner"))return t;if(t.flipped&&t.placement===t.originalPlacement)return t;var n=_(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement),o=t.placement.split("-")[0],i=C(o),r=t.placement.split("-")[1]||"",a=[];switch(e.behavior){case yt.FLIP:a=[o,i];break;case yt.CLOCKWISE:a=G(o);break;case yt.COUNTERCLOCKWISE:a=G(o,!0);break;default:a=e.behavior}return a.forEach(function(s,f){if(o!==s||a.length===f+1)return t;o=t.placement.split("-")[0],i=C(o);var p=v(t.offsets.popper),u=t.offsets.reference,d=Math.floor,l="left"===o&&d(p.right)>d(u.left)||"right"===o&&d(p.left)<d(u.right)||"top"===o&&d(p.bottom)>d(u.top)||"bottom"===o&&d(p.top)<d(u.bottom),c=d(p.left)<d(n.left),h=d(p.right)>d(n.right),m=d(p.top)<d(n.top),g=d(p.bottom)>d(n.bottom),b="left"===o&&c||"right"===o&&h||"top"===o&&m||"bottom"===o&&g,w=["top","bottom"].indexOf(o)!==-1,y=!!e.flipVariations&&(w&&"start"===r&&c||w&&"end"===r&&h||!w&&"start"===r&&m||!w&&"end"===r&&g);(l||b||y)&&(t.flipped=!0,(l||b)&&(o=a[f+1]),y&&(r=z(r)),t.placement=o+(r?"-"+r:""),t.offsets.popper=vt({},t.offsets.popper,T(t.instance.popper,t.offsets.reference,t.placement)),t=M(t.instance.modifiers,t,"flip"))}),t}function X(t){var e=v(t.offsets.popper),n=t.offsets.reference,o=t.placement.split("-")[0],i=Math.floor,r=["top","bottom"].indexOf(o)!==-1,a=r?"right":"bottom",s=r?"left":"top",f=r?"width":"height";return e[a]<i(n[s])&&(t.offsets.popper[s]=i(n[s])-e[f]),e[s]>i(n[a])&&(t.offsets.popper[s]=i(n[a])),t}function $(t,e,n,o){var i=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),r=+i[1],a=i[2];if(!r)return t;if(0===a.indexOf("%")){var s=void 0;switch(a){case"%p":s=n;break;case"%":case"%r":default:s=o}var f=v(s);return f[e]/100*r}if("vh"===a||"vw"===a){var p=void 0;return p="vh"===a?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),p/100*r}return r}function J(t,e,o,i){var r=[0,0],a=["right","left"].indexOf(i)!==-1,s=t.split(/(\+|\-)/).map(function(t){return t.trim()}),f=s.indexOf(B(s,function(t){return t.search(/,|\s/)!==-1}));s[f]&&s[f].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var p=/\s*,\s*|\s+/,u=f!==-1?[s.slice(0,f).concat([s[f].split(p)[0]]),[s[f].split(p)[1]].concat(s.slice(f+1))]:[s];return u=u.map(function(t,n){var i=(1===n?!a:a)?"height":"width",r=!1;return t.reduce(function(t,e){return""===t[t.length-1]&&["+","-"].indexOf(e)!==-1?(t[t.length-1]=e,r=!0,t):r?(t[t.length-1]+=e,r=!1,t):t.concat(e)},[]).map(function(t){return $(t,i,e,o)})}),u.forEach(function(t,e){t.forEach(function(o,i){n(o)&&(r[e]+=o*("-"===t[i-1]?-1:1))})}),r}function Q(t,e){var o=e.offset,i=t.placement,r=t.offsets,a=r.popper,s=r.reference,f=i.split("-")[0],p=void 0;return p=n(+o)?[+o,0]:J(o,a,s,f),"left"===f?(a.top+=p[0],a.left-=p[1]):"right"===f?(a.top+=p[0],a.left+=p[1]):"top"===f?(a.left+=p[0],a.top-=p[1]):"bottom"===f&&(a.left+=p[0],a.top+=p[1]),t.popper=a,t}function Z(t,e){var n=e.boundariesElement||u(t.instance.popper),o=_(t.instance.popper,t.instance.reference,e.padding,n);e.boundaries=o;var i=e.priority,r=v(t.offsets.popper),a={primary:function(t){var n=r[t];return r[t]<o[t]&&!e.escapeWithReference&&(n=Math.max(r[t],o[t])),gt({},t,n)},secondary:function(t){var n="right"===t?"left":"top",i=r[n];return r[t]>o[t]&&!e.escapeWithReference&&(i=Math.min(r[n],o[t]-("right"===t?r.width:r.height))),gt({},n,i)}};return i.forEach(function(t){var e=["left","top"].indexOf(t)!==-1?"primary":"secondary";r=vt({},r,a[e](t))}),t.offsets.popper=r,t}function tt(t){var e=t.placement,n=e.split("-")[0],o=e.split("-")[1];if(o){var i=t.offsets.reference,r=v(t.offsets.popper),a=["bottom","top"].indexOf(n)!==-1,s=a?"left":"top",f=a?"width":"height",p={start:gt({},s,i[s]),end:gt({},s,i[s]+i[f]-r[f])};t.offsets.popper=vt({},r,p[o])}return t}function et(t){if(!q(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,n=B(t.instance.modifiers,function(t){return"preventOverflow"===t.name}).boundaries;if(e.bottom<n.top||e.left>n.right||e.top>n.bottom||e.right<n.left){if(t.hide===!0)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(t.hide===!1)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}function nt(t){var e=t.placement,n=e.split("-")[0],o=v(t.offsets.popper),i=v(t.offsets.reference),r=["left","right"].indexOf(n)!==-1,a=["top","left"].indexOf(n)===-1;return o[r?"left":"top"]=i[e]-(a?o[r?"width":"height"]:0),t.placement=C(e),t.offsets.popper=v(o),t}function ot(t){return{getBoundingClientRect:function(){return t.getBounds()||{top:0,left:0,bottom:0,right:0,width:0,height:0}},get clientWidth(){return this.getBoundingClientRect().width},get clientHeight(){return this.getBoundingClientRect().height}}}for(var it=["native code","[object MutationObserverConstructor]"],rt=function(t){return it.some(function(e){return(t||"").toString().indexOf(e)>-1})},at="undefined"!=typeof window,st=["Edge","Trident","Firefox"],ft=0,pt=0;pt<st.length;pt+=1)if(at&&navigator.userAgent.indexOf(st[pt])>=0){ft=1;break}var ut=at&&rt(window.MutationObserver),dt=ut?t:e,lt=void 0,ct=function(){return void 0===lt&&(lt=navigator.appVersion.indexOf("MSIE 10")!==-1),lt},ht=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},mt=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),gt=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},vt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},bt=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],wt=bt.slice(3),yt={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},xt={shift:{order:100,enabled:!0,fn:tt},offset:{order:200,enabled:!0,fn:Q,offset:0},preventOverflow:{order:300,enabled:!0,fn:Z,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:X},arrow:{order:500,enabled:!0,fn:K,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:V,behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:nt},hide:{order:800,enabled:!0,fn:et},applyStyle:{order:900,enabled:!0,fn:U,onLoad:Y,gpuAcceleration:!0}},_t={placement:"bottom",eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:xt},Et=function(){function t(e,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ht(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=dt(this.update.bind(this)),this.options=vt({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e.jquery?e[0]:e,this.popper=n.jquery?n[0]:n,o(this.popper,{position:"absolute"}),this.modifiers=Object.keys(t.Defaults.modifiers).map(function(e){return vt({name:e},t.Defaults.modifiers[e])}),this.modifiers=this.modifiers.map(function(t){var e=a.modifiers&&a.modifiers[t.name]||{};return vt({},t,e)}),a.modifiers&&(this.options.modifiers=vt({},t.Defaults.modifiers,a.modifiers),Object.keys(a.modifiers).forEach(function(e){if(void 0===t.Defaults.modifiers[e]){var n=a.modifiers[e];n.name=e,r.modifiers.push(n)}})),this.modifiers=this.modifiers.sort(function(t,e){return t.order-e.order}),this.modifiers.forEach(function(t){t.enabled&&i(t.onLoad)&&t.onLoad(r.reference,r.popper,r.options,t,r.state)}),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return mt(t,[{key:"update",value:function(){return N.call(this)}},{key:"destroy",value:function(){return A.call(this)}},{key:"enableEventListeners",value:function(){return j.call(this)}},{key:"disableEventListeners",value:function(){return I.call(this)}}]),t}();Et.Utils=("undefined"!=typeof window?window:global).PopperUtils,Et.placements=bt,Et.Defaults=_t;var Ot=5,Lt={placement:"top",modifiers:{offset:{offset:"0,"+Ot},preventOverflow:{padding:Ot,boundariesElement:"viewport"}}},kt={created:function(){this.__poppers=[]},anchor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.placement,o=void 0===n?"top":n;this.__poppers.push(new Et(ot(this),t,Object.assign({},Lt,{placement:o})))},updateAnchors:function(){this.__poppers.forEach(function(t){return t.scheduleUpdate()})}},Ct={_alignImage:function(t){var e=Polymer.dom(t).rootTarget.dataset.align,n=this.editor.plugins.image;this.editor.embed("image",Object.assign({},n.meta,{alignment:e}))}},Tt={_embed:function(t){var e=Polymer.dom(t).rootTarget.dataset.embed;this.editor.embed(e,{src:"http://cdn.simpla.io/img/logo/logo-wordmark.png"})}},Bt=[13,27],Pt=2,Mt={properties:{_linkHref:{type:String,value:""},_rangeLinkActive:{type:Boolean,observer:"_updateLink"}},_format:function(t){var e=Polymer.dom(t).rootTarget.dataset.format;this.editor.toggleFormat(e)},_formatHeading:function(){var t=this.editor.plugins.heading;t.applied&&t.meta.level<Pt?this.editor.format("heading",{level:t.meta.level+1}):t.applied&&t.meta.level===Pt?this.editor.removeFormat("heading"):this.editor.format("heading",{level:1})},_toggleLink:function(){this._rangeLinkActive=!this._rangeLinkActive},_updateLink:function(t){var e=this.editor.plugins.link.meta,n=this._linkHref.trim();t?(this._linkHref=e&&e.href?e.href:"",this.$["range-link-input"].focus()):(this.editor.removeFormat("link"),n&&this.editor.format("link",{href:n}))},_exitLinkOnExitKeys:function(t){Bt.indexOf(t.keyCode)!==-1&&(this._rangeLinkActive=!1)}},Nt={newLine:{placement:"left"},image:{placement:"top"},range:{placement:"top"}};Polymer({is:"simpla-article-toolbar",properties:{context:{type:String,value:""},editor:{type:Object,observer:"_updateEditorBindings"},state:{type:Object,value:function(){return{}}}},behaviors:[kt,Mt,Tt,Ct],listeners:{keyup:"_stopEvent",keydown:"_stopEvent",keypress:"_stopEvent"},attached:function(){this._setupToolbars()},_setupToolbars:function(){var t=this;Polymer.dom(this.root).querySelectorAll("[data-context]").forEach(function(e){t.anchor(e,Nt[e.dataset.context])})},getBounds:function(){return this.editor?this.editor.getSelectionBounds():null},_updateEditorBindings:function(t,e){var n=this;this.__closeToolbars=this.__closeToolbars||function(){n.context=null},this.__updatePositions=this.__updatePositions||function(){n.updateAnchors()},this.__updateContext=this.__updateContext||function(){var e=t.selection.empty,o=t.plugins.image;o.applied?n.context="image":o.applicable?n.context="newLine":e?n.context=null:n.context="range"},this.__updateState=this.__updateState||function(t){n.set("state."+t.name,t)},t&&(t.on("select",this.__updatePositions),t.on("select",this.__updateContext),t.on("plugin",this.__updateContext),t.on("plugin",this.__updateState),this.__updatePositions(),this.__updateContext()),e&&(t.off("select",this.__updatePositions),t.off("select",this.__updateContext),t.off("plugin",this.__updateContext),t.off("plugin",this.__updateState))},_isContext:function(t,e){return t===e},_stopEvent:function(t){t.stopPropagation()},_equals:function(t,e){return t===e}})}(); </script> </dom-module> 
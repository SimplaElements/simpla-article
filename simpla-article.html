<link rel="import" href="../polymer/polymer.html"> <link rel="import" href="../simpla-element-behavior/simpla-element-behavior.html"> <dom-module id="simpla-article"> <template> <style>:host{display:block}:host([contenteditable]){outline:0}:host::after{content:'';display:table;clear:both}:host ::slotted(img::-moz-selection){background:0 0}:host ::slotted(img::selection){background:0 0}:host([contenteditable]) ::slotted(img){cursor:pointer}:host([contenteditable]) ::slotted(img.ProseMirror-selectednode){border:1px solid var(--simpla-primary-color)}</style> <slot></slot> </template> <script>!function(){"use strict";var e=["simpla-article-toolbar.html","../simpla-richtext-behavior/simpla-richtext-behavior.html"],t=["bold","italic","link","list","heading","blockquote","image"],i=document.createElement("simpla-article-toolbar"),r={observers:["_initEditor(editable)","_syncEditableToEditor(editable)"],_importEditorDeps:function(){var t=this,i=e.map(function(e){return new Promise(function(i,r){t.importHref(t.resolveUrl(e),i,r)})});return Promise.all(i)},_initEditor:function(e){var r=this,n=void 0,o=void 0;e&&!this._editor&&(n=function(){var e=window.SimplaBehaviors.RichText,n=new e(r,{inline:!1,placeholder:r.placeholder,plugins:t,editable:r.editable,typographer:!r.noTypographer});n.on("focus",function(){return i.editor=n}),n.on("blur",function(){i.editor=null,i.context=""}),r._editor=n},o=function(){i.parentElement||document.body.appendChild(i)},this._importEditorDeps().then(n).then(o))},_syncEditableToEditor:function(e){var t=this._editor;t&&(t.editable=e)}},n={type:"Article",dataProperties:["value"]};Polymer({is:"simpla-article",properties:{placeholder:{type:String,value:"Enter your text..."},noTypographer:{type:Boolean,value:!1},active:{type:Boolean,notify:!0,value:!1},value:{type:String,value:""}},observers:["_render(value)","_ensureInactiveIfNotEditable(editable)"],listeners:{focus:"_goActive",blur:"_goInactive",input:"_refreshValue"},behaviors:[SimplaBehaviors.Element(n),r],attached:function(){this._refreshValue()},_refreshValue:function(){var e=this._editor;this.__refreshingValue=!0,this.value=e?e.getHTML():this.innerHTML,this.__refreshingValue=!1},_render:function(e){var t=this._editor;this.__refreshingValue||(t?t.setHTML(e):this.innerHTML=e)},_goActive:function(){this.editable&&(this.active=!0)},_goInactive:function(){this.active=!1},_ensureInactiveIfNotEditable:function(e){e||(this.active=!1)}})}(); </script> </dom-module> 